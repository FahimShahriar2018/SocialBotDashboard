---
title: "SocialBot Analysis Report"
output: pdf_document
fontsize: 11pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)

df <- read_excel("SocialBot.xlsx") %>%
  mutate(
    is_bot = factor(is_bot, levels=c(0,1), labels=c("Human","Bot")),
    rank_group = cut(urank, breaks=3, labels=c("Low","Medium","High"))
  )
```

# 1. Dataset Overview
```{r}
overview_tbl <- data.frame(
Metric = c("Number of rows", "Number of columns"),
Value  = c(nrow(df), ncol(df))
)
overview_tbl
```

```{r}
class_tab <- table(df$is_bot)
data.frame(
AccountType = names(class_tab),
Count       = as.numeric(class_tab)
)
```

# 2. Class Distribution
```{r}
ggplot(df, aes(x = is_bot)) +
geom_bar(fill = "steelblue") +
labs(
title = "Number of Human vs Bot Accounts",
x = "Account type",
y = "Count"
) +
theme_minimal()

```

# 3. Feature Correlations
```{r}
numeric_df <- df %>%
select(where(is.numeric))

corr_mat <- cor(numeric_df, use = "complete.obs")

corr_df  <- as.data.frame(as.table(corr_mat))
colnames(corr_df) <- c("Var1", "Var2", "Correlation")

ggplot(corr_df, aes(x = Var2, y = Var1, fill = Correlation)) +
geom_tile() +
scale_fill_gradient2(
low  = "blue",
mid  = "white",
high = "red",
midpoint = 0,
limits = c(-1, 1),
name = "Correlation"
) +
coord_fixed() +
theme_minimal(base_size = 8) +
theme(
axis.text.x = element_text(
angle = 45, hjust = 1, vjust = 1, size = 6
),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
title = "Correlation Heatmap of Numeric Features",
x = NULL,
y = NULL
)

```

# 4. Profile & Popularity

## 4.1 Follower / Following Ratio
```{r}
ggplot(df, aes(x = is_bot, y = follower_follow_rate, fill = is_bot)) +
geom_boxplot(alpha = 0.8) +
labs(
title = "Follower/Following Rate by Account Type",
x     = "Account type",
y     = "Follower/Following rate"
) +
theme_minimal() +
theme(legend.position = "none")

```

## 4.2 User Rank
```{r}
ggplot(df, aes(x = is_bot, y = urank, fill = is_bot)) +
geom_boxplot(alpha = 0.8) +
labs(
title = "User Rank (urank) by Account Type",
x     = "Account type",
y     = "User rank (urank)"
) +
theme_minimal() +
theme(legend.position = "none")

```

# 5. Activity & Engagement

## 5.1 Posting Rate
```{r}
ggplot(df, aes(x = is_bot, y = post_rate, fill = is_bot)) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(
title = "Posting Rate Distribution",
x     = "Account type",
y     = "Post rate"
) +
theme_minimal() +
theme(legend.position = "none")

```

## 5.2 Average Engagement
```{r}
engagement_summary <- df %>%
group_by(is_bot) %>%
summarise(
comments = mean(ave_comment,   na.rm = TRUE),
reposts  = mean(ave_repost,    na.rm = TRUE),
likes    = mean(ave_attitudes, na.rm = TRUE),
.groups  = "drop"
) %>%
pivot_longer(
cols      = c(comments, reposts, likes),
names_to  = "metric",
values_to = "value"
)

ggplot(engagement_summary, aes(x = metric, y = value, fill = is_bot)) +
geom_col(position = "dodge") +
labs(
title = "Average Engagement by Account Type",
x     = "Engagement metric",
y     = "Mean value",
fill  = "Account type"
) +
theme_minimal()

```

## 5.3 Histogram of Follower/Following Rate
```{r}
# Match the "current" histogram style (same as your Download SVG logic)
x_min <- 0
x_max <- 1
binwidth <- 0.025

df2 <- df %>%
  mutate(follower_follow_rate = as.numeric(follower_follow_rate)) %>%
  filter(!is.na(follower_follow_rate)) %>%
  mutate(follower_follow_rate = pmax(follower_follow_rate, 0)) %>%
  filter(follower_follow_rate >= x_min, follower_follow_rate <= x_max)

breaks <- seq(x_min, x_max + binwidth, by = binwidth)

hist_df <- df2 %>%
  mutate(bin_left = cut(
    follower_follow_rate,
    breaks = breaks,
    include.lowest = TRUE,
    right = FALSE
  )) %>%
  count(is_bot, bin_left, name = "n") %>%
  tidyr::complete(is_bot, bin_left, fill = list(n = 0)) %>%
  mutate(
    bin_start = as.numeric(gsub("\\[|\\(|,.*", "", as.character(bin_left))),
    bin_mid   = bin_start + binwidth / 2
  ) %>%
  arrange(is_bot, bin_mid)

ggplot(hist_df, aes(x = bin_mid, y = n, fill = is_bot)) +
  geom_col(
    width = binwidth * 0.98,
    position = "identity",
    alpha = 0.60,
    colour = "white",
    linewidth = 0.2
  ) +
  scale_fill_manual(values = c("Human" = "lightblue", "Bot" = "red")) +
  coord_cartesian(xlim = c(x_min, x_max)) +
  scale_x_continuous(
    breaks = c(0, 0.25, 0.50, 0.75, 1.00),
    labels = sprintf("%.2f", c(0, 0.25, 0.50, 0.75, 1.00))
  ) +
  theme_minimal(base_size = 11) +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(
    title = "Histogram of Follower/Following Rate by Account Type",
    x     = "Follower/Following rate",
    y     = "Count",
    fill  = "Account type"
  )
```

# 6. Content & Timing
```{r}
url_text_long <- df %>%
select(is_bot, ave_url, cvar_url, cvar_textlength) %>%
pivot_longer(
cols      = c(ave_url, cvar_url, cvar_textlength),
names_to  = "measure",
values_to = "value"
) %>%
mutate(
measure = recode(
measure,
"ave_url"         = "Average URL use",
"cvar_url"        = "URL variability",
"cvar_textlength" = "Text length variability"
)
)

ggplot(url_text_long, aes(x = is_bot, y = value, fill = is_bot)) +
geom_boxplot(alpha = 0.8) +
facet_wrap(~ measure, scales = "free_y") +
labs(
title = "URL and Text Variability by Account Type",
x     = "Account type",
y     = "Value"
) +
theme_minimal() +
theme(legend.position = "none")

```

# 7. Principal Component Analysis (PCA)
## 7.1 Pairwise Scatter: Follower–Follow Rate vs cvar_url
```{r}

ggplot(df, aes(x = follower_follow_rate, y = cvar_url, color = is_bot)) +
geom_point(size = 2, alpha = 0.8) +
theme_minimal(base_size = 11) +
scale_color_manual(values = c("Human" = "steelblue", "Bot" = "red")) +
labs(
title = "Follower–Follow Rate vs URL Variability (cvar_url)",
x     = "Follower/Following rate",
y     = "URL variability (cvar_url)",
color = "User Type"
)


```

## 7.2 Pairwise Scatter: Follower–Follow Rate vs uRank
```{r}

ggplot(df, aes(x = follower_follow_rate, y = urank, color = is_bot)) +
geom_point(size = 2, alpha = 0.8) +
theme_minimal(base_size = 11) +
scale_color_manual(values = c("Human" = "steelblue", "Bot" = "red")) +
labs(
title = "Follower–Follow Rate vs User Rank (urank)",
x     = "Follower/Following rate",
y     = "User rank (urank)",
color = "User Type"
)


```

## 7.3 PCA Scatter Plot (PC1 vs PC2)
```{r}

# Select numeric columns

numeric_df <- df %>% select(where(is.numeric))

# Remove is_bot from PCA features

feature_cols <- setdiff(colnames(numeric_df), "is_bot")
X <- numeric_df[, feature_cols, drop = FALSE]

# Remove zero-variance columns

zero_var <- sapply(X, function(v) sd(v, na.rm = TRUE) == 0)
X <- X[, !zero_var, drop = FALSE]

# Complete cases only

complete_idx <- complete.cases(X)
X_complete   <- X[complete_idx, ]
is_bot_complete <- df$is_bot[complete_idx]

# PCA

pca_res <- prcomp(X_complete, center = TRUE, scale. = TRUE)

pca_df <- as.data.frame(pca_res$x[, 1:2])
colnames(pca_df) <- c("PC1", "PC2")
pca_df$is_bot <- is_bot_complete

ggplot(pca_df, aes(x = PC1, y = PC2, color = is_bot)) +
geom_point(size = 2, alpha = 0.8) +
theme_minimal(base_size = 11) +
scale_color_manual(values = c("Human" = "steelblue", "Bot" = "red")) +
labs(
title = "PCA Scatter Plot (PC1 vs PC2)",
x     = "PC1",
y     = "PC2",
color = "User Type"
)


```

